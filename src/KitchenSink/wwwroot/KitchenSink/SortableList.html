<template>

    <template is="dom-bind" id="root">
        <h1>Sortable List</h1>
                
            <table class="table table-striped table-hover">
                <sortable-js on-sort="moved">
                    <thead>
                        <tr>
                            <th>Firstname</th>
                            <th>Lastname</th>
                            <th>Sort</th>
                        </tr>
                    </thead>
                    <tbody id="myList">
                        <template is="dom-repeat" items="{{model.Persons}}">
                            <tr class="drag success">
                                <td> {{item.FirstName}}</td>
                                <td>{{item.LastName}}</td>
                                <td>
                                    <button class="btn btn-sm btn-default jawher-btn" on-mousedown="up" disabled$="{{item.isFirst}}" item="{{item}}" ><i class="fa fa-thumbs-up" aria-hidden="true"></i></button>
                                    <button class="btn btn-sm btn-default  jawher-btn" on-mousedown="down" disabled$="{{item.isLast}}" item="{{item}}"><i class="fa fa-thumbs-down" aria-hidden="true"></i></button>
                                </td>
                            </tr>
                        </template>
                    </tbody>
                </sortable-js> 
            </table>
        
</template>



    <script>

        (function () {
            var script = document._currentScript || document.currentScript;
            var template = script.previousElementSibling;


            template.up = function (ev) {
                var item = ev.currentTarget.item;
                var index = template.model.Persons.indexOf(item);
                console.log(template.model.Up$);
                template.set("model.index$", index);
                template.set("model.Up$", ++template.model.Up$);
            };

            template.down = function (ev) {
                var item = ev.currentTarget.item;
                var index = template.model.Persons.indexOf(item);
                template.set("model.index$", index);
                template.set("model.Down$", ++template.model.Down$);

            };

            template.moved = function (ev) {
                
                var from = ev.detail.oldIndex + 1;
                var to = ev.detail.newIndex + 1;
                template.set("model.index$", from);
                template.set("model.to$", to);
                template.set("model.Drag$", ++template.model.Drag$);
                console.log(from + "====>" + to);
 
            };
       
        })();
        
 </script>
</template>